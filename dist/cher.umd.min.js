/*!
 * Cher v1.0.1
 * https://gitlab.com/cherjs/cher
 * Copyright (c) 2022 Haász Sándor
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).cher=t()}(this,(function(){"use strict";function e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function t(t){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?e(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):e(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function r(e,t,r,n,a,i,s){try{var o=e[i](s),l=o.value}catch(e){return void r(e)}o.done?t(l):Promise.resolve(l).then(n,a)}function n(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var s=e.apply(t,n);function o(e){r(s,a,i,o,l,"next",e)}function l(e){r(s,a,i,o,l,"throw",e)}o(void 0)}))}}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,o(e,t,"get"))}function s(e,t,r){return function(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}(e,o(e,t,"set"),r),r}function o(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function l(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}function u(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function c(e,t,r){u(e,t),t.set(e,r)}function h(e,t){u(e,t),t.add(e)}var d=void 0;function f(e){return Object.freeze(e)}function p(){return Object.create(null)}function v(e,t){var r;null!==(r=t)&&void 0!==r||(t=p());for(var n=p(),a=0;a<e.length;++a)n[e[a]]=t[e[a]];return n}function b(e){return v(Object.keys(e),e)}var w=f(b({GET:1,HEAD:1,POST:1,PUT:1,DELETE:1,CONNECT:1,OPTIONS:1,TRACE:1,PATCH:1})),m=f(b({GET:1,HEAD:1,CONNECT:1,OPTIONS:1,TRACE:1})),y=f(b({101:1,103:1,204:1,205:1,304:1})),g=String;function E(e){return void 0===e}function k(e){return Object(e)===e}function T(e){return Array.isArray(e)}function O(e,t,r){return e instanceof t||Object.prototype.toString.call(e)==="[object ".concat(r,"]")}function j(e,t,r){var n,a,i,s;r=k(r)?[g(null!==(n=r[0])&&void 0!==n?n:""),g(null!==(a=r[1])&&void 0!==a?a:"")]:[g(null!==(i=r)&&void 0!==i?i:""),g(null!==(s=r)&&void 0!==s?s:"")];var o=g(null!=e?e:"");return k(t)&&Object.keys(t).forEach((e=>{o=o.split("".concat(r[0]).concat(e).concat(r[1])).join(t[e])})),o}var S=function e(t){for(var r,n,a=arguments.length,i=new Array(a>1?a-1:0),s=1;s<a;s++)i[s-1]=arguments[s];var o=i.length?e(...i):(null===(r=document)||void 0===r?void 0:r.baseURI)||(null===(n=location)||void 0===n?void 0:n.href);return""===g(t)&&(t=o),new URL(t,o)};function D(e,t){return[new URLSearchParams(null!=e?e:d).toString(),new URLSearchParams(null!=t?t:d).toString()].filter(Boolean).join("&")}function P(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];var i=S(t,...n);return new URLSearchParams(e).forEach(((e,t)=>{i.searchParams.append(t,e)})),i.href}function U(e){if(O(e,FormData,"FormData"))return e;if(O(e,HTMLFormElement,"HTMLFormElement"))return new FormData(e);var t=new FormData;if(T(e)){for(var r=0;r<e.length;++r)t.append(...e[r]);return t}return O(e,URLSearchParams,"URLSearchParams")?(e.forEach(((e,r)=>{t.append(r,e)})),t):k(e)?(Object.keys(e).forEach((r=>{t.append(r,...T(e[r])?e[r]:[e[r]])})),t):new FormData(e)}class L extends Error{constructor(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];super(t??"HTTP ".concat(e.status||"<unknown-status>"," ").concat(e.statusText||""),...n),Error.captureStackTrace&&Error.captureStackTrace(this,L),this.name="ResponseError",this.response=e}}if("function"!=typeof fetch)throw new Error("The fetch() is not supported.");var R,W=f(b({json:(R=n((function*(e){var t=yield e.text();return t?JSON.parse(t):d})),function(e){return R.apply(this,arguments)}),"strict-json":"json",text:"text",url:"formData",form:"formData",blob:"blob",file:"blob",stream:!1,buffer:"arrayBuffer",none:d})),A=f(b({json:1,text:1,url:1,form:1,blob:1,file:1,stream:1,buffer:1,none:1})),C=b({method:d,evalTemplate:()=>j,delimiters:()=>["{","}"],baseURL:d,url:d,args:d,params:d,decode:"json",encode:"json",data:d,options:d}),x=t({},C),M=Object.keys(C),F=[...M],N=[...M,"listeners"];function H(e){return(e=g(e).toUpperCase())in w?e:d}function B(e){return"string"==typeof e||O(e,URL,"URL")}var G=new WeakMap,I=new WeakMap,z=new WeakMap,J=new WeakMap,q=new WeakMap,K=new WeakMap,Q=new WeakMap,V=new WeakMap,X=new WeakMap,Y=new WeakMap,Z=new WeakMap,$=new WeakSet,_=new WeakSet,ee=new WeakSet,te=new WeakSet,re=new WeakSet,ne=new WeakSet,ae=new WeakSet,ie=new WeakSet,se=new WeakSet,oe=new WeakSet,le=new WeakSet;class ue extends EventTarget{constructor(){super(),h(this,le),h(this,oe),h(this,se),h(this,ie),h(this,ae),h(this,ne),h(this,re),h(this,te),h(this,ee),h(this,_),h(this,$),c(this,G,{writable:!0,value:void 0}),c(this,I,{writable:!0,value:void 0}),c(this,z,{writable:!0,value:void 0}),c(this,J,{writable:!0,value:[]}),c(this,q,{writable:!0,value:void 0}),c(this,K,{writable:!0,value:void 0}),c(this,Q,{writable:!0,value:void 0}),c(this,V,{writable:!0,value:void 0}),c(this,X,{writable:!0,value:void 0}),c(this,Y,{writable:!0,value:void 0}),c(this,Z,{writable:!0,value:void 0}),this.reset(),this.set(...arguments)}get method(){return i(this,G)}set method(e){s(this,G,H(e))}get evalTemplate(){return i(this,I)}set evalTemplate(e){s(this,I,"function"==typeof e?e:e=>e)}get delimiters(){return i(this,z)}set delimiters(e){var t,r;s(this,z,k(e)?[g(null!==(t=e[0])&&void 0!==t?t:""),g(null!==(r=e[1])&&void 0!==r?r:"")]:[g(null!=e?e:""),g(null!=e?e:"")])}get baseURL(){return i(this,J)}set baseURL(e){var t;null!==(t=e)&&void 0!==t||(e=[]),T(e)||(e=[...i(this,J),e]),s(this,J,e.reduce(((e,t)=>{var r;return(t=g(null!==(r=t)&&void 0!==r?r:""))&&e.push(t),e}),[]))}get url(){return i(this,q)}set url(e){s(this,q,g(null!=e?e:""))}get args(){return i(this,K)}set args(e){s(this,K,null!=e?e:d)}get params(){return i(this,Q)}set params(e){s(this,Q,null!=e?e:d)}get decode(){return i(this,V)}set decode(e){s(this,V,e in W?g(e):d)}get encode(){return i(this,X)}set encode(e){s(this,X,e in A?g(e):d)}get data(){return i(this,Y)}set data(e){s(this,Y,e)}get options(){return i(this,Z)}set options(e){if(k(e)){if("method"in(e=t({},e))){var r=H(e.method);E(r)?delete e.method:e.method=r}}else e=d;s(this,Z,e)}getDefault(e){return C[e]}setDefault(e,t,r){e in M&&(C[e]=t,r&&(this[e]="function"==typeof C[e]?C[e]():C[e]))}resetDefault(e,t){this.setDefault(e,x[e],t)}getDefaults(){return v(M,C)}setDefaults(){for(var e,t,r,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];B(a[0])?([t,a,r]=a,a.url=t):[a,r]=a,null!==(e=a)&&void 0!==e||(a=p()),M.forEach((e=>{e in a&&this.setDefault(e,a[e],r)})),E(t)||this.setDefault("url",t,r)}resetDefaults(e){this.setDefaults(x,e)}reset(e){var t=e?x:C;M.forEach((e=>{this[e]="function"==typeof t[e]?t[e]():t[e]}))}set(){for(var e,t,r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];B(n[0])?[t,n]=n:[n]=n,null!==(e=n)&&void 0!==e||(n=p()),F.forEach((e=>{e in n&&(this[e]=n[e])})),E(t)||(this.url=t)}getConfig(){return v(F,this)}getURL(){for(var e,r,n,a,i,s,o=arguments.length,l=new Array(o),u=0;u<o;u++)l[u]=arguments[u];B(l[0])?[s,l]=l:[l]=l,null!==(e=l)&&void 0!==e||(l=p());var{evalTemplate:c,delimiters:h,baseURL:f,args:v,params:b}=l;return E(s)&&({url:s}=l),c="function"==typeof c?c:this.evalTemplate,null!==(r=h)&&void 0!==r||(h=this.delimiters),f=[...this.baseURL,...(T(f)?f:[f]).reduce(((e,t)=>{var r;return(t=g(null!==(r=t)&&void 0!==r?r:""))&&e.push(t),e}),[])],s=g(null!==(n=s)&&void 0!==n?n:this.url),function(e,t,r,n,a){for(var i=arguments.length,s=new Array(i>5?i-5:0),o=5;o<i;o++)s[o-5]=arguments[o];return P(n,...[a,...s].map((n=>e(g(null!=n?n:""),r,t))))}(c,h,v=t(t({},this.args),null!==(a=v)&&void 0!==a?a:d),b=D(this.params,null!==(i=b)&&void 0!==i?i:d),s,...f.reverse())}getOptions(e){var r;null!==(r=e)&&void 0!==r||(e=p());var{decode:n,encode:a,data:i}=e,{method:s,options:o}=e;if(E(s=H(s))&&(s=this.method),s&&(s={method:s}),k(o)){if("method"in(o=t({},o))){var u=H(o.method);E(u)?delete o.method:o.method=u}}else o=d;s=(o=t(t(t({method:"GET"},this.options),o),s)).method,o.headers=new Headers(o.headers);var{headers:c}=o;return l(this,$,ce).call(this,c,n),l(this,_,he).call(this,s,c,o,a,i),o}fetch(){for(var e,t=this,r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];B(a[0])?[e,a]=a:[a]=a,a=v(N,a),E(e)||(a.url=e);var{listeners:s}=a,o={instance:this,fetchConfig:a};l(this,le,ge).call(this,"start",{detail:o},s),o.fetchUrl=this.getURL(a),o.fetchOptions=this.getOptions(a);var u=fetch(o.fetchUrl,o.fetchOptions);return o.fetch=u,l(this,le,ge).call(this,"started",{detail:o},s),o.fetch.then((e=>{if(o.response=e,l(this,le,ge).call(this,"loaded",{detail:o},s),!o.response.ok)throw new L(o.response);return l(this,le,ge).call(this,"checked",{detail:o},s),o.response})).then(function(){var e=n((function*(e){if(e.status in y||null==e.body)l(t,le,ge).call(t,"bodyless",{detail:o},s);else{var r,{decode:n}=a;n=g(null!==(r=n)&&void 0!==r?r:"")||t.decode,(n=W[n])?(e.data="function"==typeof n?yield n(e):yield e[n](),l(t,le,ge).call(t,"decoded",{detail:o},s)):(e.data=e.body,l(t,le,ge).call(t,"unprocessed",{detail:o},s))}return o.response}));return function(t){return e.apply(this,arguments)}}()).catch((e=>{if(o.error=e,l(this,le,ge).call(this,"error",{detail:o},s),null!=o.error)throw l(this,le,ge).call(this,"uncatched",{detail:o},s),o.error;return l(this,le,ge).call(this,"catched",{detail:o},s),o.response})).finally((()=>{l(this,le,ge).call(this,"end",{detail:o},s)}))}create(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return!0===t[0]&&(t[0]=this.getConfig()),Ee(...t)}}function ce(e,t){var r;switch(t=t in W?g(t):this.decode){case"json":r="application/json,text/plain,*/*";break;case"text":r="text/plain,*/*";break;case"url":r="application/x-www-form-urlencoded,*/*";break;case"form":r="application/x-www-form-urlencoded,multipart/form-data,*/*";break;case"blob":case"file":case"stream":case"buffer":e.has("Accept")||(r="*/*")}return r||e.has("Accept")||(r="*/*"),r&&e.set("Accept",r),e}function he(e,t,r,n,a){if(e=H(e),n=n in A?g(n):this.encode,e in m)t.delete("Content-Type"),delete r.body;else if(E(a)&&E(this.data))E(r.body)&&(t.delete("Content-Type"),delete r.body);else switch(n){case"json":t.set("Content-Type","application/json;charset=UTF-8"),r.body=l(this,ee,de).call(this,a);break;case"text":t.set("Content-Type","text/plain;charset=UTF-8"),r.body=l(this,te,fe).call(this,a);break;case"url":t.set("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"),r.body=l(this,re,pe).call(this,a);break;case"form":t.delete("Content-Type"),r.body=l(this,ne,ve).call(this,a);break;case"blob":r.body=l(this,ie,we).call(this,a);break;case"file":r.body=l(this,se,me).call(this,a);break;case"stream":r.body=l(this,oe,ye).call(this,a);break;default:r.body=E(a)?this.data:a}}function de(e){return T(e)?T(this.data)&&(e=[...this.data,...e]):k(e)?k(this.data)&&!T(this.data)&&(e=t(t({},this.data),e)):E(e)&&(e=this.data),JSON.stringify(e)}function fe(e){return g(E(e)?this.data:e)}function pe(e){return D(this.data,e)}function ve(e){if(E(this.data))return U(e);var t=U(this.data);return E(e)||U(e).forEach(((e,r)=>{t.append(r,e)})),t}function be(e,t,r){return O(e=E(e)?this.data:e,t,r)?e:(T(e)||(e=[e]),new t(T(e[0])?e[0]:[e[0]],...e.slice(1)))}function we(e){return l(this,ae,be).call(this,e,Blob,"Blob")}function me(e){return l(this,ae,be).call(this,e,File,"File")}function ye(e){return O(e=E(e)?this.data:e,ReadableStream,"ReadableStream")?e:new ReadableStream(...T(e)?e:[e])}function ge(e,t,r){var n,a;null!==(n=t)&&void 0!==n||(t=p());var{detail:i}=t;(r=null===(a=r)||void 0===a?void 0:a[e])&&(r=T(r)?[...r]:[r]).forEach(((t,n)=>{T(t)||(r[n]=[t]),this.addEventListener(e,...r[n])})),this.dispatchEvent(new CustomEvent(e,{detail:i})),r&&r.forEach((t=>{this.removeEventListener(e,...t)}))}function Ee(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=new ue(...t),a=n.fetch.bind(n);return["method","evalTemplate","delimiters","baseURL","url","args","params","decode","encode","data","options"].forEach((e=>{Object.defineProperty(a,e,{get:()=>n[e],set(t){n[e]=t}})})),["addEventListener","removeEventListener","dispatchEvent","getDefault","setDefault","resetDefault","getDefaults","setDefaults","resetDefaults","reset","set","getConfig","getURL","getOptions","fetch","create"].forEach((e=>{Object.defineProperty(a,e,{configurable:!0,writable:!0,value:n[e].bind(n)})})),a}return Ee()}));
//# sourceMappingURL=cher.umd.min.js.map
